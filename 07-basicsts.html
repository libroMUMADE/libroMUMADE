<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Analítica predictiva avanzada - 2&nbsp; Conceptos y herramientas básicas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-etsSSOE.html" rel="next">
<link href="./01-intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-basicsts.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conceptos y herramientas básicas</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Analítica predictiva avanzada</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prólogo</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-basicsts.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conceptos y herramientas básicas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-etsSSOE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Suavizado Exponencial</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-etsSSOEenSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Suavizado exponencial en Espacio de los Estados</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-etsMSOE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Suavizado Exponencial con mútiples ruidos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-extensiones.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Aplicaciones</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-introR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apéndice A: Introducción a los lenguajes de programación</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-tutorialUComp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apéndice B: Tutorial de UComp</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li>
<a href="#procesos-estoc%C3%A1sticos" id="toc-procesos-estocásticos" class="nav-link active" data-scroll-target="#procesos-estoc%C3%A1sticos"><span class="header-section-number">2.1</span> Procesos estocásticos</a>
  <ul class="collapse">
<li><a href="#momentos-de-procesos-estoc%C3%A1sticos" id="toc-momentos-de-procesos-estocásticos" class="nav-link" data-scroll-target="#momentos-de-procesos-estoc%C3%A1sticos"><span class="header-section-number">2.1.1</span> Momentos de procesos estocásticos</a></li>
  <li><a href="#algunos-procesos-estoc%C3%A1sticos" id="toc-algunos-procesos-estocásticos" class="nav-link" data-scroll-target="#algunos-procesos-estoc%C3%A1sticos"><span class="header-section-number">2.1.2</span> Algunos procesos estocásticos</a></li>
  </ul>
</li>
  <li><a href="#estacionariedad" id="toc-estacionariedad" class="nav-link" data-scroll-target="#estacionariedad"><span class="header-section-number">2.2</span> Estacionariedad</a></li>
  <li>
<a href="#transformaciones-de-estacionariedad" id="toc-transformaciones-de-estacionariedad" class="nav-link" data-scroll-target="#transformaciones-de-estacionariedad"><span class="header-section-number">2.3</span> Transformaciones de estacionariedad</a>
  <ul class="collapse">
<li><a href="#Box-Cox" id="toc-Box-Cox" class="nav-link" data-scroll-target="#Box-Cox"><span class="header-section-number">2.3.1</span> Transformación de varianza</a></li>
  <li><a href="#transformaci%C3%B3n-de-media" id="toc-transformación-de-media" class="nav-link" data-scroll-target="#transformaci%C3%B3n-de-media"><span class="header-section-number">2.3.2</span> Transformación de media</a></li>
  </ul>
</li>
  <li><a href="#contraste-de-hip%C3%B3tesis-para-modelos-de-series-temporales" id="toc-contraste-de-hipótesis-para-modelos-de-series-temporales" class="nav-link" data-scroll-target="#contraste-de-hip%C3%B3tesis-para-modelos-de-series-temporales"><span class="header-section-number">2.4</span> Contraste de hipótesis para modelos de series temporales</a></li>
  <li><a href="#m%C3%A9todos-y-modelos-de-predicci%C3%B3n" id="toc-métodos-y-modelos-de-predicción" class="nav-link" data-scroll-target="#m%C3%A9todos-y-modelos-de-predicci%C3%B3n"><span class="header-section-number">2.5</span> Métodos y modelos de predicción</a></li>
  <li><a href="#esquema-general-de-an%C3%A1lisis-de-series-temporales" id="toc-esquema-general-de-análisis-de-series-temporales" class="nav-link" data-scroll-target="#esquema-general-de-an%C3%A1lisis-de-series-temporales"><span class="header-section-number">2.6</span> Esquema general de análisis de series temporales</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Conceptos y herramientas básicas</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="procesos-estocásticos" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="procesos-estocásticos">
<span class="header-section-number">2.1</span> Procesos estocásticos</h2>
<p>Para hacer un tratamiento estadístico más riguroso en este libro necesitamos una definición más técnica de serie temporal. Desde este punto de vista definimos un <strong>proceso estocástico</strong> como una sucesión de variables aleatorias con una distribución de probabilidad dada indexadas por el tiempo. Cada una de las variables aleatorias del proceso tiene su propia función de distribución de probabilidad y pueden o no estar correlacionadas entre sí. Una <strong>serie temporal</strong> es una realización de dicho proceso estocástico, es decir, una sucesión de valores que son extraídos aleatoriamente de la distribución correspondiente. En el panel superior de la <a href="#fig-fig11">Figura&nbsp;<span>2.1</span></a> se observa un proceso estocástico en el que la ley de probabilidad se mantiene constante en el tiempo, aunque la realización concreta (puntos) no son una constante. En el panel inferior se puede ver lo complicado que puede ser un proceso estocástico, puesto que en ese caso la función de distribución es distinta para cada momento del tiempo, y ¡además el intervalo de muestro no es fijo!</p>
<div id="fig-fig11" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="fig11.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.1: Dos procesos estocásticos con diferentes características.</figcaption></figure>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Solución</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">MATLAB/Octave</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Borra toda la memoria. Carga las herramientas del libro. Simula un ruido blanco normal de dimensión 300 con media 100, represéntala gráficamente. Comprueba que la media es 100.</p>
<p>En <strong>R</strong> puedes usar las funciones <code>rm</code>, <code><a href="https://rdrr.io/r/base/library.html">library(UComp)</a></code>, <code><a href="https://ggplot2.tidyverse.org">library(ggplot2)</a></code>), <code>rnorm</code>, <code>autoplot</code> y <code>sumStats</code>. <code>autoplot</code> función solo representa objetos de series temporales, que puedes convertir con la función <code>as.ts</code>.</p>
<p>En <strong>Python</strong> tendrás que usar, por ejemplo, <code>from UComp import *</code>, <code>np.random.normal</code>, <code>plt.plot</code>, <code>sumStats</code>. Para convertir matrices o vectores <code>numpy</code> a series termporales de <code>pandas</code> puedes usar la función <code>ts</code>.</p>
<p>En <strong>MATLAB/OCtave</strong> puedes usar <code>randn</code>, <code>plot</code> y <code>sumStats</code>.</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<pre><code>##                         Serie 1
## Data points:          300.00000
## Missing:                0.00000
## Minimum:               97.11108
## 1st quartile:          99.41095
## Mean:                 100.03358
## P(Mean = 0):            0.00000
## Median:                99.96156
## 3rd quartile:         100.67273
## Maximum:              102.64917
## Interquartile range:    1.26179
## Range:                  5.53809
## Satandard deviation:    0.96370
## Variance:               0.92871
## Skewness:               0.01617
## Kurtosis:               0.05266</code></pre>
</div>
<p>La media efectivamente es muy próxima a 100. Si se desea hacer un test formal se puede restar 100 a los datos y hacer el test de que la media es cero.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">sumStats</span><span class="op">(</span><span class="va">a</span> <span class="op">-</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">##                         Serie 1</span></span>
<span><span class="co">## Data points:          300.00000</span></span>
<span><span class="co">## Missing:                0.00000</span></span>
<span><span class="co">## Minimum:               -2.88892</span></span>
<span><span class="co">## 1st quartile:          -0.58905</span></span>
<span><span class="co">## Mean:                   0.03358</span></span>
<span><span class="co">## P(Mean = 0):            0.54656</span></span>
<span><span class="co">## Median:                -0.03844</span></span>
<span><span class="co">## 3rd quartile:           0.67273</span></span>
<span><span class="co">## Maximum:                2.64917</span></span>
<span><span class="co">## Interquartile range:    1.26179</span></span>
<span><span class="co">## Range:                  5.53809</span></span>
<span><span class="co">## Satandard deviation:    0.96370</span></span>
<span><span class="co">## Variance:               0.92871</span></span>
<span><span class="co">## Skewness:               0.01617</span></span>
<span><span class="co">## Kurtosis:               0.05266</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como se ve el p-valor del test de que la media es cero es 54%, lo que indica que con un amplio margen no se rechaza la hipótesis de que la media es cero (la variable original tiene media 100).</p>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Borramos memoria</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Cargamos librerías</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">UComp</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co"># Generamos números aleatorios gaussianos</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span></span>
<span><span class="co"># Representación gráfica</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Estadísticos</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/sumStats.html">sumStats</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos librerías</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>from UComp import <span class="sc">*</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generamos números aleatorios gaussianos</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">np.random.normal</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">300</span>) <span class="sc">+</span> <span class="dv">100</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Representación gráfica</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plt.plot</span>(a)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticos</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sumStats</span>(a)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sumStats</span>(a <span class="sc">-</span> <span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>% Borramos memoria</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>clear all</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>% Generamos números aleatorios gaussianos</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">randn</span>(<span class="dv">300</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="dv">100</span>;</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>% Representación gráfica</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(a)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>% Estadísticos</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sumStats</span>(a)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">sumStats</span>(a <span class="sc">-</span> <span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>En la vida real vamos a tener por lo general una sola realización de cada proceso estocástico, que de hecho son los datos observados. Es decir, si tenemos los datos mensuales de ventas de una empresa, cada dato es una realización de una función de distribución que desconocemos y que puede estar cambiando en el tiempo. Esto limita mucho el análisis, puesto que, si tuviéramos muchas realizaciones del mismo proceso estocástico podríamos estimar las leyes de probabilidad con mucha precisión. Normalmente, al disponer solo de una realización, la falta de información la tendremos que suplir con un cúmulo de supuestos sobre dichas distribuciones de probabilidad.</p>
<p>Con estas definiciones, la predicción implica continuar la sucesión de variables aleatorias basándonos en las propiedades observadas en las anteriores. De esta forma podemos predecir toda la función de probabilidad de la variable, o solamente algunos momentos de la distribución (media, la mediana, la moda, la varianza, etc.). Así podemos obtener <strong>predicciones de toda la densidad</strong>, solo <strong>predicciones puntuales</strong> (normalmente la media o la mediana) o predicciones puntuales con algún <strong>intervalo de confianza</strong> o <strong>predicción</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Predicción con inteligencia artificial
</div>
</div>
<div class="callout-body-container callout-body">
<p>Aunque es evidente que hay similitudes, la predicción en el contexto de sección cruzada (análisis de imagen, sonido, etc.), tan habitual en nuestros días por la abundancia de aplicaciones de inteligencia artificial, es radicalmente diferente a la predicción de lo que puede suceder en el futuro en un sentido temporal. Efectivamente, alguien puede <em>entrenar</em> un modelo con millones de caras diferentes para reconocimiento facial y luego puede <em>predecir</em>, es decir, reconocer, que un objeto nuevo presentado al modelo es una cara o reconocer a una persona concreta. Para que esto pueda ser operativo se supone que las caras que puedan aparecer nuevas serán como las anteriores con las que se ha entrenado el modelo. Sin embargo, cuando se pretende predecir algo en el dominio del tiempo puede suceder que el futuro de un determinado fenómeno pueda resultar totalmente diferente a lo que ha sucedido hasta ahora, de forma que el modelo no servirá para nada.</p>
<p>Desde luego, hay determinadas variables para las que el supuesto de que el futuro es semejante al pasado suena plausible, por ejemplo, en el caso de la radiación solar, que es un fenómeno físico. Pero en series de naturaleza económica, por ejemplo, el tema es bastante más incierto, piénsese por ejemplo, cómo influyen las turbulencias financieras, guerras o pandemias en las variables económicas. Desgraciadamente, hasta hace poco estos fenómenos los considerábamos poco probables ne Occidente.</p>
</div>
</div>
<p>Sea como fuere, si queremos predecir el futuro no tendremos más remedio que suponer que el futuro será como el pasado. Si hay dudas más que razonables de que esto sea cierto, entonces, lo más prudente será utilizar planteamientos alternativos a los que se presentan en este libro.</p>
<section id="momentos-de-procesos-estocásticos" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="momentos-de-procesos-estocásticos">
<span class="header-section-number">2.1.1</span> Momentos de procesos estocásticos</h3>
<p>Se pueden calcular momentos de procesos estocásticos de forma sencilla, basándonos en los momentos de las funciones de distribución. Suponiendo que <span class="math inline">\(Y(t)\)</span> es un proceso estocástico, los que más nos van a interesar son:</p>
<ul>
<li>
<strong>Media</strong>: <span class="math inline">\(E[Y(t)]=\mu_y(t)\)</span>. Es la esperanza matemática.</li>
<li>
<strong>Varianza</strong>: <span class="math inline">\(Var[Y(t)]=\sigma^2_y(t)=E[Y(t)^2]-E[Y(t)]^2=E[Y(t)^2]-\mu_y(t)^2\)</span>. Es la esperanza matemática de las desviaciones respecto a la media.</li>
<li>
<strong>Autocovarianzas</strong>: <span class="math inline">\(\gamma_{i-j}=E[Y(i)-\mu_y(i)]E[Y(j)-\mu_y(j)]\)</span>. Mide la covarianza en dos momentos del tiempo. Dada esta definición, las autocovarianzas son simétricas, <span class="math inline">\(\gamma_{i-j}=\gamma_{j-i}\)</span>. Cuando <span class="math inline">\(i=j\)</span>, <span class="math inline">\(\gamma_0=Var[Y(t)]\)</span>, la autocovarianza de orden cero es la varianza. Las <strong>autocorrelaciones</strong> son las autocovarianzas normalizadas por la varianza, <span class="math inline">\(\rho_{i-j}=\gamma_{i-j}/\gamma_0\)</span>, de forma que tomará valores entre -1 y 1, indicando correlación perfecta en los extremos o no autocorrelación en caso de que valga cero.</li>
</ul></section><section id="algunos-procesos-estocásticos" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="algunos-procesos-estocásticos">
<span class="header-section-number">2.1.2</span> Algunos procesos estocásticos</h3>
<p>Ya estamos en condiciones de analizar algunos procesos estocásticos sencillos que usaremos en el futuro.</p>
<ul>
<li>
<strong>Ruido blanco</strong>: se trata de un proceso puramente aleatorio. Es una simple sucesión de números aleatorios extraídos de alguna función de distribución. Se asume que tendrá media y varianza constante. Lo único significativo de este proceso es la media, por lo que la predicción óptima es su media, puesto que todo lo que sucede alrededor de la media es impredecible por definición.</li>
<li>
<strong>Paseo aleatorio</strong> (<em>Radom Walk</em> o RW en inglés): se trata de un proceso discreto en la variable tiempo (<span class="math inline">\(t\)</span>) que obedece a la ecuación <span class="math inline">\(y_t=y_{t-1}+a_t\)</span>, siendo <span class="math inline">\(a_t\)</span> un ruido blanco. Es decir, el valor presente es el mismo que el anterior con una perturbación aleatoria que puede ser positiva o negativa. La predicción óptima de este modelo será el valor anterior debido a que la mejor predicción de <span class="math inline">\(a_t\)</span> es su media. Cuando se predicen varios periodos hacia adelante la mejor predicción es el último valor observado.</li>
<li>
<strong>Paseo aleatorio con deriva</strong>: se trata de un proceso que obedece a la ecuación <span class="math inline">\(y_t=c+y_{t-1}+a_t\)</span>, siendo <span class="math inline">\(c\)</span> una constante. Es igual que el anterior pero con una constante que le imprime una pendiente lineal ascendente o descendente si el signo de la contante es positivo o negativo, respectivamente. En efecto, si llamamos <span class="math inline">\(T\)</span> al momento de la última observación disponible, la predicción óptima de la variable <span class="math inline">\(y_t\)</span> para el momento <span class="math inline">\(T+i, i=1,2,\dots,l\)</span> con la información hasta la observación <span class="math inline">\(T\)</span> se denota por <span class="math inline">\(\hat{y}_{T+i|T}\)</span> y se puede obtener aplicando recursivamente la fórmula del modelo:</li>
</ul>
<p><span class="math display">\[
\begin{array}{l}
\hat{y}_{T+1|T} = c + y_{T} \\
\hat{y}_{T+2|T} = c + \hat{y}_{T+1|T} = 2c + y_{T} \\
\vdots \\
\hat{y}_{T+l|T} = c + \hat{y}_{T+l-1|T} = 2c + \hat{y}_{T+l-2|T} = \dots = lc + y_{T} \\
\end{array}
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
El paseo aleatorio
</div>
</div>
<div class="callout-body-container callout-body">
<p>Karl Pearson en una carta a la revista <em>Nature</em> en 1905 asemejó el modelo del paseo aleatorio a la trayectoria de un borracho. Esto se debe a que la posición del pobre hombre es la anterior con una pequeña modificación en su entorno que es puramente aleatoria debido a su estado de embriaguez.</p>
</div>
</div>
<p>La <a href="#fig-fig14">Figura&nbsp;<span>2.2</span></a> muestra la predicción de estos procesos estocásticos partiendo de distintos orígenes de predicción. Las predicciones se muestran en color rojo y los datos en negro. El panel superior izquierdo muestra el caso de un ruido blanco en el que se ve cómo al añadir datos va cambiando la estimación de la media y por tanto la predicción. El panel superior derecho es un paseo aleatorio y la predicción es el último dato observado. Los paneles inferiores muestran los casos de paseos aleatorios con deriva positiva (izquierda) y negativa (derecha).</p>
<div id="fig-fig14" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="fig14.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.2: Predicción óptima de procesos estocásticos sencillos.</figcaption></figure>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Solución</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">MATLAB/Octave</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>Simula un ruido blanco Normal con media cero y varianza uno de longitud 100. Represéntala gráficamente y muestra la media y la varianza por pantalla.</p>
<p>Simula un paseo aleatorio basándote en el ruido blanco con una condición inicial de 100 anterior con un bucle <code>for</code>. Dibújala.</p>
<p>Simula un paseo aleatorio con deriva de 1 basándote en el ruido blanco anterior. Dibújala.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Media: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="st">"   /   Varianza: "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Media:  0.0516018586359169    /   Varianza:  0.983419578990251</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span> <span class="op">:</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span> <span class="op">:</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">y</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulación</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co"># Representación gráfica</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Mostrando valores </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Media: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, <span class="st">"   /   Varianza: "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Media:  -0.0391342405607215    /   Varianza:  1.36799275552134</span></span>
<span><span class="co"># Simulando paseo aleatorio con condición inicial 100</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span> <span class="op">:</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulando paseo aleatorio con deriva</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span> <span class="op">:</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="va">y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">y</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Representación gráfica</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plt.plot(a)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrando valores</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Media: "</span> <span class="op">+</span> <span class="ss">f"</span><span class="sc">{</span>np<span class="sc">.</span>mean(a)<span class="sc">:.4f}</span><span class="ss">"</span>  <span class="op">+</span> <span class="st">"   /   Varianza: "</span> <span class="op">+</span> <span class="ss">f"</span><span class="sc">{</span>np<span class="sc">.</span>var(a)<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulando paseo aleatorio con condición inicial 100</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.full((<span class="dv">100</span>), <span class="dv">100</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>):</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>     y[t] <span class="op">=</span> y[t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> a[t]</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>plt.plot(y)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulando paseo aleatorio con deriva</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.full((<span class="dv">100</span>), <span class="dv">100</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>):</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>     y[t] <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> y[t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> a[t]</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>plt.plot(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Simulación</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> randn(<span class="dv">100</span>, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Representación gráfica</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plot(a)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Mostrando valores </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>[<span class="st">'Media: '</span> num2str(mean(a)) <span class="st">'   /   Varianza: '</span> num2str(var(a))]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Simulando paseo aleatorio con condición inicial <span class="dv">100</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> repmat(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="op">=</span> <span class="dv">2</span> : <span class="dv">100</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>     y(t) <span class="op">=</span> y(t <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> a(t)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>plot(y)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Simulando paseo aleatorio con deriva</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> repmat(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="op">=</span> <span class="dv">2</span> : <span class="dv">100</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>     y(t) <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> y(t <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> a(t)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>plot(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="estacionariedad" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="estacionariedad">
<span class="header-section-number">2.2</span> Estacionariedad</h2>
<p>Dadas las definiciones previas queda clara la definición de otro concepto central en el estudio de series temporales, que es el de <strong>estacionariedad</strong>. Se dice que un proceso estocástico es <strong>estacionario en sentido estricto</strong> cuando la función de distribución es independiente del tiempo (eso es lo que sucede en el caso del panel superior de la <a href="#fig-fig11">Figura&nbsp;<span>2.1</span></a>). Este concepto es tan restrictivo que a menudo se utiliza otro que es la <strong>estacionariedad débil</strong> que implica que la media y la varianza del proceso son constantes y las autocovarianzas dependen solo de las diferencias de tiempo en que se miden pero no del momento particular en que se miden. Por ejemplo, la autocovarianza de orden 2 (<span class="math inline">\(\gamma_2\)</span>) toma siempre el mismo valor se mida al principio del proceso, en medio o al final. Si la distribución es Gaussiana, entonces estacionariedad débil equivale a la estricta, puesto que la distribución normal queda completamente determinada por los dos primeros momentos de la distribución.</p>
<p>El concepto de estacionariedad vino para permitir estimaciones cuando solo se tiene una realización del proceso estocástico, que es lo que suele suceder. Si asumimos estacionariedad, entonces podemos estimar los momentos de la distribución (que es constante en el tiempo) con los momentos muestrales. Si suponemos que <span class="math inline">\(y_t\)</span> es una realización del proceso estocástico estacionario <span class="math inline">\(Y(t)\)</span>, tenemos:</p>
<ul>
<li>Media: <span class="math inline">\(E[Y(t)]=\mu_y=1/n \sum_1^n y_t\)</span>.</li>
<li>Varianza: <span class="math inline">\(Var[Y(t)]=\sigma^2_y= 1/n \sum_1^n (y_t - \mu_y)^2 =1/n \sum_1^n y_t^2 - \mu_y^2\)</span>.</li>
<li>Autocovarianzas: <span class="math inline">\(\gamma_{i}=1 / n \sum_1^n (y_t-\mu_y)(y_{t-i}-\mu_y)\)</span>. Las autocorrelaciones son <span class="math inline">\(\rho_i=\gamma_i/\gamma_0\)</span>.</li>
</ul>
<p>En cualquier caso, estos estadísticos se pueden calcular siempre para cualquier serie temporal, incluso para las no estacionarias. Pero no tendrán ninguna interpretación, ningún sentido cuando el proceso estocástico del que proceden sea no estacionario, porque solo se calcula un solo valor para cada uno de ellos cuando en realidad están cambiando en el tiempo.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Solución</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>¿Será estacionaria en media una serie temporal con tendencia?</p>
<p>¿Son estacionarias en media y varianza las series de la <a href="01-intro.html#fig-fig10">Figura&nbsp;<span>1.2</span></a>?</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>¿Será estacionaria en media una serie temporal con tendencia?</p>
<p>No.&nbsp;Precisamente la tendencia lo que implica es que la media cambia en el tiempo.</p>
<p>¿Son estacionarias en media y varianza las series de la <a href="01-intro.html#fig-fig10">Figura&nbsp;<span>1.2</span></a>?</p>
<p>El IBEX-35 y los pasajeros de avión no son estacionarios ni en media ni varianza. El pib no es estacionario en media, pero podría serlo en varianza. El caudal del Nilo puede ser estacionario en varianza, y salvo un salto cerca del año 1900, podría ser estacionario en media también.</p>
</div>
</div>
</div>
<p>A la representación de las autocorrelaciones frente al retardo se llama <strong>función de autocorrelación simple</strong> y es de suma utilidad en el análisis de series temporales (<em>ACF</em> es el acrónimo en inglés). Por extensión se define la <strong>función de autocorrelación parcial</strong> a la representación gráfica de los coeficientes de correlación parcial frente al retardo (<em>PACF</em> en inglés). Las <strong>autocorrelaciones parciales</strong> miden la autocorrelación entre dos momentos del tiempo cuando se han tenido en cuenta simultáneamente todos los retardos intermedios o cuando se han descontado todas las relaciones intermedias. serían los coeficientes (<span class="math inline">\(c_{i,i}, i=1,2,\dots, k\)</span>) de las siguientes regresiones:</p>
<p><span class="math display">\[
\begin{array}{l}
y_t = c_{1,0} + c_{1,1} y_{t-1} + a_{1,t} \\
y_t = c_{2,0} + c_{2,1} y_{t-1} + c_{2,2} y_{t-2} + a_{2,t} \\
\vdots \\
y_t = c_{k,0} + c_{k,1} y_{t-1} + c_{k,2} y_{t-2} + c_{k,k} y_{t-k} + \dots  + a_{k,t} \\
\end{array}
\]</span></p>
<p>La <a href="#fig-fig12">Figura&nbsp;<span>2.3</span></a> muestra un ejemplo de funciones de autocorrelación simple y parcial.</p>
<div id="fig-fig12" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="fig12.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.3: Funciones de autocorrelación simple y parcial.</figcaption></figure>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Solución</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">MATLAB/Octave</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Demuestra que un paseo aleatorio con deriva no es estacionario en media. Para ello asume que la serie temporal sigue la ecuación <span class="math inline">\(y_t=c+y_{t-1}+a_t\)</span> y calcula la media de forma recursiva empezando por <span class="math inline">\(E(y_1)\)</span> y asumiendo que <span class="math inline">\(E(y_0)=0\)</span>.</p>
<p>Realiza una simulación de longitud 100 con deriva <span class="math inline">\(c=1\)</span> y estima su función de autocorrelación simple y parcial.</p>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Si calculamos las medias de forma recursiva tenemos:</p>
<p><span class="math display">\[
\begin{array}{c}
E(y_1)=E(c+y_0+a_t)=c+E(y_0)=c \\
E(y_2)=c+E(y_1)=2c \\
\vdots \\
E(y_t)=tc
\end{array}
\]</span></p>
<p>La media depende del tiempo, por lo que el proceso no es estacionario.</p>
<p>Una simulación de longitud 100 con deriva <span class="math inline">\(c=1\)</span> tiene el siguiente aspecto:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Como se ve, la serie tienen una tendencia lineal clara que depende de la deriva. La <strong>ACF</strong> tiende a cero muy lentamente y la <em>PACF</em> muestra un único valor cercano a 1, algo que es síntoma de que la serie no es estacionaria. No obstante, la <strong>ACF</strong> y <em>PACF</em> no significan nada en este caso, puesto que para su cálculo correcto la serie temporal debe ser estacionaria, hipótesis que sabemos que no es cierta.</p>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulando paseo aleatorio con deriva</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span> <span class="op">:</span> <span class="fl">100</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">y</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/tsDisplay.html">tsDisplay</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulando paseo aleatorio con deriva</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.zeros(<span class="dv">100</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">100</span>):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>     y[t] <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> y[t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> a[t]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>tsDisplay(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Simulando paseo aleatorio con deriva</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> zeros(<span class="dv">100</span>, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> randn(<span class="dv">100</span>, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="op">=</span> <span class="dv">2</span> : <span class="dv">100</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    y(t) <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> y(t <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> a(t)<span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>toolTEST(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<!-- ## Medidas de error de predicción -->
<!-- Independientemente de si se utilizan métodos o modelos formales para realizar la predicción de cualquier variable, algo que nos va a interesar siempre es comprobar la calidad de las predicciones, su nivel de precisión e incluso comparar la precisión de distintos métodos para las mismas series, con el fin de elegir el mejor. -->
<!-- Denotamos por $\hat{y}_{T+l|T}$ a la predicción de la variable $y_t$, $l$ periodos hacia adelante con origen de predicción $T$. El **error de predicción** $l$ **periodos hacia adelante con origen** $T$ se define como la diferencia entre la predicción y el valor real, es decir, $\hat{e}_{T+l|T}=\hat{y}_{T+l|T}-y_{T+l}$. Con esta definición resulta un error positivo siempre que la predicción esté por encima del valor real y viceversa. El error porcentual es el mismo error dividido por los valores reales de la variable original, la predicción o una combinación de ambas. Es un error sin unidades y puede ser útil para comparar modelos en distintas series temporales. -->
<!-- Dos propiedades importantes de los errores de predicción son: -->
<!-- -   **Sesgo**: es la diferencia entre la predicción y el valor real en media. La predicción será insesgada cuando en media el sesgo sea cero o la media del error de predicción sea cero. Evidentemente para predicciones individuales el error nunca será exactamente cero, pero lo ideal es que el errores positivos se compensen con errores negativos. -->
<!-- -   **Error cuadrático medio**: es la media de los errores al cuadrado. Naturalmente, el método o modelo de predicción será mejor cuanto menor sea este valor. Normalmente se utiliza la raíz cuadrada de este valor para que tenga las mismas unidades que la variable o el valor absoluto, como se ve más abajo. A menudo se calcula también el **Error absoluto medio**, como vamos a ver en seguida. -->
<!-- En el mundo real es bastante habitual evaluar métodos y modelos sobre la base de diversas medidas de error agregadas para un conjunto de predicciones sobre una serie temporal, como muestra la @fig-tab11. En dicha figura se promedian siempre funciones del error de predicción con un horizonte de $n$ periodos hacia adelante desde el origen de predicción, que será por lo general el final de la muestra, la observación $T$-ésima. Para no perderse en la figura es conveniente tener en cuenta lo siguiente: -->
<!-- -   Las medidas absolutas en la columna central se calculan sobre los errores absolutos y, por tanto, tienen las mismas unidades que la variable original. Las métricas relativas son las mismas que las anteriores pero calculadas sobre los errores porcentuales. -->
<!-- -   La primera fila refleja los valores medios de los errores con su signo, es decir, está reflejando el sesgo de la predicción. El resto de métricas se refieren al error cuadrático medio o el error absoluto medio, que reflejan la precisión de la predicción. -->
<!-- -   La segunda fila y la quinta miden el error medio en términos absolutos o porcentuales y el error cuadrático medio, respectivamente. -->
<!-- -   Para evitar el problema numérico que puede generar en las medidas relativas el hecho de que las observaciones reales se aproximen a cero, se utilizan otras medidas de error que contemplan en los denominadores otras magnitudes: -->
<!--     -   En el caso del *error medio absoluto simétrico* (sMAPE) los denominadores son la media de valores absolutos de valores reales y predicciones. -->
<!--     -   En el *error medio absoluto escalado* (MASE) y en la *raíz del error cuadrático medio escalado* (RMSSE) el denominador es el error medio absoluto de la predicción de un paseo aleatorio dentro de la muestra. De esta forma se compara la precisión de las predicciones *fuera* de la muestra con la precisión de un modelo sencillo *dentro* de la muestra. -->
<!-- ![Medidas de error.](tab11.png){#fig-tab11} -->
<!-- ```{r tab11, fig.cap="Medidas de error.", echo=FALSE, fig.align="center"} -->
<!-- # knitr::include_graphics("tab11.png") -->
<!-- ``` -->
<!-- ::: panel-tabset -->
<!-- ## Resuelve -->
<!-- Borra toda la memoria y carga las librerías que necesites (`rm`, `UComp`, `ggplot2`). Representa la serie pasajeros de avión en la variable `airpas` frente al tiempo con `autoplot`. La escala es muy grande, divide por 100. -->
<!-- Tomando los datos desde enero de 1995 hasta febrero de 2020, estima las predicciones a partir de marzo con los métodos sencillos (el `naive`, `naive estacional` y `media anual`) hasta el final de la muestra. Muestra las predicciones y los valores reales (`autoplot` + `autolayer`). -->
<!-- ¿Qué modelo es el que tiene mayor precisión fuera de la muestra (`Accuracy`)? Estima los pasajeros que se han perdido por la pandemia (`colSums`). -->
<!-- ## Solución -->
<!-- Borra toda la memoria y carga las librerías que necesites (`rm`, `UComp`, `ggplot2`). Representa la serie pasajeros de avión en la variable `pasajeros` frente al tiempo con `autoplot`. La escala es muy grande, divide por 100. -->
<!-- ```{r collapse=TRUE, echo=c(-2,-3), fig.height=3} -->
<!-- rm(list = ls()) -->
<!-- suppressPackageStartupMessages(library("UComp")) -->
<!-- suppressPackageStartupMessages(library("ggplot2")) -->
<!-- library(UComp) -->
<!-- library(ggplot2) -->
<!-- y = airpas / 100 -->
<!-- autoplot(y) + labs(title = "Pasajeros") -->
<!-- ``` -->
<!-- Tomando los datos desde enero de 1995 hasta febrero de 2020, estima las predicciones a partir de marzo con los métodos sencillos (el `naive`, `naive estacional` y `media anual`) hasta el final de la muestra. Muestra las predicciones y los valores reales (`autoplot` + `autolayer`). -->
<!-- ```{r collapse=TRUE, echo=TRUE, fig.height=3} -->
<!-- # Horizonte de predicción -->
<!-- h = 31 -->
<!-- # Seleccionamos datos entre 1995 y 2020 -->
<!-- x = window(y, start=1995, end = 2020 + 1 / 12) -->
<!-- # Predicción de modelos convirtiéndolos a objetos series temporales -->
<!-- naive = ts(rep(tail(x, 1), h), start = 2020 + 2 / 12, frequency = 12) -->
<!-- snaive = ts(head(rep(tail(x, 12), 3), h), start = 2020 + 2 / 12, frequency = 12) -->
<!-- mediaAnual = ts(rep(mean(tail(x, 12)), h), start = 2020 + 2 / 12, frequency = 12) -->
<!-- # Representando serie y predicciones -->
<!-- autoplot(tail(y, 80)) +  -->
<!--     autolayer(naive) +  -->
<!--     autolayer(snaive) +  -->
<!--     autolayer(mediaAnual) -->
<!-- ``` -->
<!-- ¿Qué modelo es el que tiene mayor precisión fuera de la muestra (`Accuracy`)? Estima los pasajeros que se han perdido por la pandemia (`colSums`). -->
<!-- ```{r collapse=TRUE, echo=TRUE, fig.height=2} -->
<!-- # Calculando métricas de error -->
<!-- Accuracy(cbind(naive, snaive, mediaAnual), y) -->
<!-- # Calculando viajeros perdidos -->
<!-- colSums(cbind(naive, snaive, mediaAnual) - rep(tail(y, h), 3)) -->
<!-- ``` -->
<!-- Todos los modelos están sesgados al alza (no son capaces de predecir el efecto de la pandemia) si se mira el ME y MPE. El modelo más preciso es naive, seguido de naive estacional y la media anual. -->
<!-- Los pasajeros perdidos de los modelos, serían 166, 367 y 348 millones en los 31 meses evaluados según el naive, snaive y mediAnual, respectivamente. -->
<!-- ::: -->
</section><section id="transformaciones-de-estacionariedad" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="transformaciones-de-estacionariedad">
<span class="header-section-number">2.3</span> Transformaciones de estacionariedad</h2>
<p>Hemos visto que la aplicación rigurosa de la estadística al análisis de procesos estocásticos requiere del supuesto de estacionariedad. Sin embargo, ya podemos avanzar que muchos de los casos reales de series temporales no exhiben esta propiedad (ver, por ejemplo, la <a href="01-intro.html#fig-fig10">Figura&nbsp;<span>1.2</span></a>). Por ello, es habitual aplicar algunas transformaciones previas con el fin de inducir estacionariedad, antes de proceder al análisis estadístico de las mismas.</p>
<p>Habitualmente el análisis de la estacionariedad se restringe a su acepción débil, que unido al supuesto de normalidad en realidad es equivalente a utilizar la estacionariedad en sentido estricto.</p>
<section id="Box-Cox" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="Box-Cox">
<span class="header-section-number">2.3.1</span> Transformación de varianza</h3>
<p>El problema de varianza no constante (o <strong>heterocedasticidad</strong>) a veces se soluciona con la transformación Box-Cox, que es efectiva siempre que exista alguna relación entre la media y la varianza de la serie. La transformación es</p>
<p><span id="eq-BoxCox"><span class="math display">\[
z_t= \Biggl\{ \begin{array}{rl}
          \ln(y_t) &amp; \text{si } \lambda = 0 \\
          \frac{(y_t^{\lambda} - 1)}{\lambda} &amp; \text{si } \lambda \neq 0
        \end{array}
\tag{2.1}\]</span></span></p>
<p>Como se ve, la transformación depende de una parámetro <span class="math inline">\(\lambda\)</span>. Como casos particulares tenemos <span class="math inline">\(\lambda = 1\)</span> (no hay transformación); <span class="math inline">\(\lambda = 0,5\)</span> ( raíz cuadrada); <span class="math inline">\(\lambda = 0\)</span> (logaritmo natural); <span class="math inline">\(\lambda = -0,5\)</span> (inversa de raíz cuadrada); <span class="math inline">\(\lambda = -1\)</span> (inversa).</p>
<p>A menudo los resultados no son muy sensibles a grandes variaciones del coeficiente <span class="math inline">\(\lambda\)</span>, por lo que muchos analistas sencillamente toman sistemáticamente el logaritmo natural u otras trasformaciones reconocibles, como la raíz cuadrada o la inversa. Además, se trata de una transformación que no se puede utilizar si la serie tiene valores negativos, en cuyo caso se puede sumar una constante.</p>
<p>Una cuestión interesante es que la transformación cambia las unidades de la variable y al deshacer la transformación para recuperar la escala original las predicciones siempre serán positivas. De forma que es una modo eficiente de restringir las predicciones para que sean positivas, al margen del problema de heterocedasticidad.</p>
<p>La <a href="#fig-figBoxcox">Figura&nbsp;<span>2.4</span></a> muestra los efectos de la transformación. Como se puede ver a simple vista, en este caso un valor negativo no muy alejado de cero puede estabilizar la varianza.</p>
<div id="fig-figBoxcox" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figBoxcox.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.4: La transformación Box-Cox en acción.</figcaption></figure>
</div>
<p>Existen procedimientos para estimar el coeficiente <span class="math inline">\(\lambda\)</span> de forma óptima, que se tratará con más detenimiento más adelante. Lo ideal es estimar este parámetro conjuntamente con los demás parámetros de cualquier modelo, pero la dificultad que esto entraña lleva a estimarlo previamente y comprobar a posteriori que la transformación tiene sentido. Un procedimiento es el de Guerrero, que consiste en minimizar el coeficiente de variación (desviación típica dividido por la media) de segmentos de la serie original, típicamente años enteros. Este procedimiento aplicado a la serie de la <a href="#fig-figBoxcox">Figura&nbsp;<span>2.4</span></a> arroja un valor de <span class="math inline">\(\lambda=-0,078\)</span>, que indica que el logaritmo es una buena aproximación.</p>
<p>Es bastante habitual que esta transformación se utilice automáticamente, a pesar de que existen casos en los que no puede funcionar, puesto que, como se dijo al principio, se asume que existe una relación directa o inversa entre la media y la varianza. En la <a href="#fig-figNofunciona">Figura&nbsp;<span>2.5</span></a> se muestra un caso simulado en el que hay oscilaciones cíclicas y el valor óptimo de <span class="math inline">\(\lambda\)</span> tiende a ser negativo y grande. En casos que no funciona la forma de tratar el problema es incorporar términos en el modelo que tratan la heterocedasticidad explícitamente.</p>
<div id="fig-figNofunciona" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figNofunciona.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.5: Un caso en el que la transformación Box-Cox no funciona.</figcaption></figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Una cuestión a tener en cuenta es que normalmente le hipótesis de homocedasticidad (varianza constante) se hace sobre los residuos, por lo que la palabra final sobre la conveniencia de la transformación tiene que recaer en contraste de hipótesis de cambios de varianza sobre los mismos, como veremos más tarde.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Solución</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">MATLAB/Octave</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Borra toda la memoria y carga las librerías que necesites. Genera una variable <code>x</code> de la serie de pasajeros de avión (<code>pasajeros</code>) desde el inicio hasta febrero de 2020 y represéntala gráficamente. ¿Es estacionaria la varianza?</p>
<p>Crea una función para calcular la transformación Box-Cox (que se llame <code>box.cox</code>) que tenga como entradas una serie temporal y el valor de <span class="math inline">\(\lambda\)</span> y como salida la variable transformada. Separa el caso particular del logaritmo cuando el valor de lambda sea en valor absoluto menor que <span class="math inline">\(1e-4\)</span>. Pruébala con distintos valores de lambda: -1, -0,5, 0, 0,5, 1, 2. Represéntalas todas gráficamente.</p>
<p>En <strong>R</strong> te pueden ser de gran ayuda función <code>grid.arrange</code> de la librería <code>gridExtra</code>. En <strong>Python</strong> te ayudará la función <code>subplot</code> de <code>matplotlib.pyplot</code>. En <strong>MATLAB/Octave</strong> puedes utilizar también <code>subplot</code>.</p>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">UComp</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html">window</a></span><span class="op">(</span><span class="va">airpas</span>, end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Función para calcular la transformación Box-Cox</span></span>
<span><span class="va">box.cox</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">lambda</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-4</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">lambda</span> <span class="op">&gt;</span> <span class="fl">0.99</span> <span class="op">&amp;&amp;</span> <span class="va">lambda</span> <span class="op">&lt;</span> <span class="fl">1.01</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">^</span> <span class="va">lambda</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Casos particulares</span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu">box.cox</span><span class="op">(</span><span class="va">x</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu">box.cox</span><span class="op">(</span><span class="va">x</span>, <span class="op">-</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu">box.cox</span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu">box.cox</span><span class="op">(</span><span class="va">x</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p5</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu">box.cox</span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p6</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu">box.cox</span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span>, <span class="va">p6</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> UComp <span class="im">import</span> <span class="op">*</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> window(airpas, end<span class="op">=</span><span class="st">"2020-02-29"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>plt.plot(x)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Función para calcular la transformación Box-Cox</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> box_cox(x, lam):</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(lam) <span class="op">&lt;</span> <span class="fl">1e-4</span>:</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.log(x)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="fl">0.99</span> <span class="op">&lt;</span> lam <span class="op">&lt;</span> <span class="fl">1.01</span>:</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> x</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (x <span class="op">**</span> lam <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> lam</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Casos particulares</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> box_cox(x, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> box_cox(x, <span class="op">-</span><span class="fl">0.5</span>)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> box_cox(x, <span class="dv">0</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>p4 <span class="op">=</span> box_cox(x, <span class="fl">0.5</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>p5 <span class="op">=</span> box_cox(x, <span class="dv">1</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>p6 <span class="op">=</span> box_cox(x, <span class="dv">2</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>plt.plot(p1)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'lambda = -1'</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>plt.plot(p2)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'lambda = -0.5'</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>plt.plot(p3)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'lambda = 0'</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>plt.plot(p4)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'lambda = 0.5'</span>)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>plt.plot(p5)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'lambda = 1'</span>)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>plt.plot(p6)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'lambda = 2'</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> airpas(<span class="dv">1</span> : <span class="dv">614</span>)<span class="op">;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>plot(x)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Función para calcular la transformación Box<span class="op">-</span>Cox</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>function y <span class="op">=</span> box_cox(x, <span class="kw">lambda</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">abs</span>(<span class="kw">lambda</span>) <span class="op">&lt;</span> <span class="fl">1e-4</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> log(x)<span class="op">;</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    elseif <span class="kw">lambda</span> <span class="op">&gt;</span> <span class="fl">0.99</span> <span class="op">&amp;&amp;</span> <span class="kw">lambda</span> <span class="op">&lt;</span> <span class="fl">1.01</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> (x .<span class="op">^</span> <span class="kw">lambda</span> <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="kw">lambda</span><span class="op">;</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Casos particulares</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> box_cox(x, <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> box_cox(x, <span class="op">-</span><span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> box_cox(x, <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>p4 <span class="op">=</span> box_cox(x, <span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>p5 <span class="op">=</span> box_cox(x, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>p6 <span class="op">=</span> box_cox(x, <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>plot(p1)<span class="op">;</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'lambda = -1'</span>)<span class="op">;</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>plot(p2)<span class="op">;</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'lambda = -0.5'</span>)<span class="op">;</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>plot(p3)<span class="op">;</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'lambda = 0'</span>)<span class="op">;</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)<span class="op">;</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>plot(p4)<span class="op">;</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'lambda = 0.5'</span>)<span class="op">;</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)<span class="op">;</span></span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>plot(p5)<span class="op">;</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'lambda = 1'</span>)<span class="op">;</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)<span class="op">;</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>plot(p6)<span class="op">;</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'lambda = 2'</span>)<span class="op">;</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>sgtitle(<span class="st">'Transformación de Box-Cox'</span>)<span class="op">;</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="transformación-de-media" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="transformación-de-media">
<span class="header-section-number">2.3.2</span> Transformación de media</h3>
<p>En el caso de la media, la <strong>diferenciación</strong> produce estacionariedad. <em>Aplicar una diferencia</em> a una serie temporal significa generar una serie en la que a cada observación se resta la anterior. La diferencia de la serie temporal <span class="math inline">\(y_t\)</span> es <span class="math inline">\(d_t=y_t-y_{t-1}\)</span>. La <a href="#fig-figDifIbex">Figura&nbsp;<span>2.6</span></a> muestra cómo una serie no estacionaria en media, como es el IBEX-35, resulta en una serie estacionaria al aplicar una diferencia.</p>
<div id="fig-figDifIbex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figDifIbex.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.6: IBEX-35 diario y su primera diferencia.</figcaption></figure>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Solución</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Demuestra que la diferencia de un paseo aleatorio es ruido blanco.</p>
<p>Demuestra que la diferencia de un paseo aleatorio con deriva es un ruido blanco con media igual a la constante del proceso.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Demuestra que la diferencia de un paseo aleatorio es ruido blanco.</p>
<p><span class="math display">\[
\begin{array}{c}
y_t=y_{t-1}+a_t \\
y_t - y_{t-1} = a_t
\end{array}
\]</span> El lado izquierdo es la diferencia de la serie original.</p>
<p>Demuestra que la diferencia de un paseo aleatorio con deriva es un ruido blanco con media igual a la constante del proceso.</p>
<p><span class="math display">\[
\begin{array}{c}
y_t=c+y_{t-1}+a_t \\
y_t - y_{t-1} = c+a_t
\end{array}
\]</span></p>
<p>Como <span class="math inline">\(a_t\)</span> tiene media cero, <span class="math inline">\(c+a_t\)</span> tendrá media <span class="math inline">\(c\)</span>.</p>
</div>
</div>
</div>
<p>Se pueden aplicar varias diferencias sucesivamente, es decir, aplicar dos diferencias es aplicar una diferencia a la primera diferencia: <span class="math inline">\(z_t=d_t-d_{t-1}=y_t-2y_{t-1}+y_{t-2}\)</span>. Se puede aplicar también una diferencia estacional cuando <em>la estacionalidad no sea estacionaria</em>, que consiste en restar a cada dato el dato del mismo periodo del año anterior, para datos mensuales <span class="math inline">\(d_t=y_t-y_{t-12}\)</span>. Se pueden mezclar los dos tipos de diferencias, por ejemplo, aplicar una diferencia regular y una estacional implica <span class="math inline">\(ddy_t=dy_t-dy_{t-12}=y_t-y_{t-1}-y_{t-12}+y_{t-13}\)</span>. La <a href="#fig-figDifs">Figura&nbsp;<span>2.7</span></a> muestra el efecto de cada uno de estos tipos de diferencias.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Estacionariedad y estacionalidad
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estos son dos términos que a menudo provocan confusión. <em>Estacionariedad</em> implica que las leyes de probabilidad no cambian en el tiempo, mientras que <em>estacionalidad</em> es la repetición, normalmente no determinista, de un ciclo con una determinada frecuencia a lo largo del tiempo.</p>
<p>Podemos tener series temporales con <em>estacionalidad estacionaria</em>, pero también las hay con <em>estacionalidad no estacionaria</em>.</p>
</div>
</div>
<div id="fig-figDifs" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figDifs.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.7: Varias combinaciones de diferencias.</figcaption></figure>
</div>
<p>La diferencia regular marca de forma clara el problema de la heterocedasticidad. La diferencia estacional diluye la estacionalidad a simple vista, pero deja la serie con oscilaciones importantes de la media. Las dos diferencias producen un <em>planchado</em> efectivo de la serie en cuanto a la estacionariedad en media. Una indicación clara de la no estacionariedad de la estacionalidad es que esta se ve a simple vista en la serie original. Sin embargo, la diferencia estacional <strong>no elimina</strong> la estacionalidad, solo la convierte en estacionaria.</p>
<p>La inducción de estacionariedad en media mediante diferenciación es típica de muchos modelos de predicción, como es la regresión con series temporales y sobre todo los modelos ARIMA. Sin embargo, en este libro, los modelos utilizados son de otra naturaleza tales que en lugar de inducir estacionariedad mediante la diferenciación la van a modelizar en forma de tendencias o de <em>especificaciones con raíces unitarias</em> de los componentes estacionales.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">Solución</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">MATLAB/Octave</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>Considera la serie temporal <code>pasajeros</code> hasta febrero de 2020. Comprueba si las series con varias diferencias son estacionarias en media. Para ello calcula y representa gráficamente los siguientes casos (<span class="math inline">\(d\)</span> es la diferencia regular y <span class="math inline">\(D\)</span> la estacional: a) <span class="math inline">\(d = 0\)</span>, <span class="math inline">\(D = 0\)</span>; b) <span class="math inline">\(d = 1\)</span>, <span class="math inline">\(D = 0\)</span>; c) <span class="math inline">\(Sd = 0\)</span>, <span class="math inline">\(D = 1\)</span>; d) <span class="math inline">\(d = 1\)</span>, <span class="math inline">\(D = 1\)</span>; e) <span class="math inline">\(d = 2\)</span>, <span class="math inline">\(D = 0\)</span>; f) <span class="math inline">\(d = 0\)</span>, <span class="math inline">\(D = 2\)</span>.</p>
<p>¿Qué transformación de media y varianza utilizarías para esta serie? Represéntala con <code>tsDisplay</code>. ¿Es ruido blanco?</p>
<p>Puedes repetir el análisis para el Índice de Producción Industrial (<code>ipi</code>) y el Producto Interior Bruto español (<code>gdp</code>).</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Utilizando la variable <code>x</code> del ejemplo anterior, las diferencias son</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La transformación de varianza más conveniente parece el logaritmo con <span class="math inline">\(d=1\)</span> y <span class="math inline">\(D=1\)</span>. La serie no es ruido blanco, puesto que hay correlaciones muy marcadas distintas de cero. El correlograma indica además la presencia de estacionalidad por los coeficientes significativos en los retardos estacionales (múltiplos de 12), aunque la estacionalidad no se ve a simple vista en el gráfico de la serie. Como ya hemos dicho, las diferencias no eliminan la estacionalidad, simplemente la hacen estacionaria.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Se puede utilizar el mismo código para analizar la serie <code>gdp</code> y sacar conclusiones.</p>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Generando diferencias</span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/dif.html">dif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/dif.html">dif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/dif.html">dif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/dif.html">dif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p5</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/dif.html">dif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p6</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/dif.html">dif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span>, <span class="va">p6</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Gráfico de serie diferenciada y funciones *ACF* y *PACF*</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/tsDisplay.html">tsDisplay</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/dif.html">dif</a></span><span class="op">(</span><span class="fu">box.cox</span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generando diferencias</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> dif(x, [<span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">12</span>])</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> dif(x, [<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">12</span>])</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> dif(x, [<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">12</span>])</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>p4 <span class="op">=</span> dif(x, [<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">12</span>])</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>p5 <span class="op">=</span> dif(x, [<span class="dv">2</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">12</span>])</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>p6 <span class="op">=</span> dif(x, [<span class="dv">0</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">12</span>])</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Representando gráficamente</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.plot(p1)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'diffs = [0, 0]'</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>plt.plot(p2)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'diffs = [1, 0]'</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>plt.plot(p3)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'diffs = [0, 1]'</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>plt.plot(p4)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'diffs = [1, 1]'</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>plt.plot(p5)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'diffs = [2, 0]'</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>plt.plot(p6)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'diffs = [0, 2]'</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de serie diferenciada y funciones *ACF* y *PACF*</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>tsDisplay(dif(box_cox(x, <span class="dv">0</span>), [<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">12</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Generando diferencias</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> vdif(x, [<span class="dv">0</span> <span class="dv">0</span>], [<span class="dv">1</span> <span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> vdif(x, [<span class="dv">1</span> <span class="dv">0</span>], [<span class="dv">1</span> <span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>p3 <span class="op">=</span> vdif(x, [<span class="dv">0</span> <span class="dv">1</span>], [<span class="dv">1</span> <span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>p4 <span class="op">=</span> vdif(x, [<span class="dv">1</span> <span class="dv">1</span>], [<span class="dv">1</span> <span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>p5 <span class="op">=</span> vdif(x, [<span class="dv">2</span> <span class="dv">0</span>], [<span class="dv">1</span> <span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>p6 <span class="op">=</span> vdif(x, [<span class="dv">0</span> <span class="dv">2</span>], [<span class="dv">1</span> <span class="dv">12</span>])<span class="op">;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Representando gráficamente</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>plot(p1)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'diffs = [0, 0]'</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>plot(p2)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'diffs = [1, 0]'</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>plot(p3)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'diffs = [0, 1]'</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>plot(p4)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'diffs = [1, 1]'</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>plot(p5)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'diffs = [2, 0]'</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>subplot(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>plot(p6)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>title(<span class="st">'diffs = [0, 2]'</span>)</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Gráfico de serie diferenciada y funciones <span class="op">*</span>ACF<span class="op">*</span> y <span class="op">*</span>PACF<span class="op">*</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>toolTEST(vdif(box_cox(x, <span class="dv">0</span>), [<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">12</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section></section><section id="contraste-de-hipótesis-para-modelos-de-series-temporales" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="contraste-de-hipótesis-para-modelos-de-series-temporales">
<span class="header-section-number">2.4</span> Contraste de hipótesis para modelos de series temporales</h2>
<p>Una característica común de todos los modelos estadísticos es el diagnóstico que se realiza a posteriori sobre el mismo, con el fin de contrastar empíricamente que las hipótesis sobre las que se basan las buenas propiedades de las estimaciones se cumplen para la muestra en estudio.</p>
<p>La mayor parte de estas hipótesis, no todas, descansan en que el residuo, la parte que el modelo no es capaz de explicar, debe ser lo más parecido a ruido blanco, es decir, un proceso puramente aleatorio independiente en el tiempo, con media y varianza constante y procedente de una distribución normal. La <a href="#fig-figTests">Figura&nbsp;<span>2.8</span></a> muestra algunos resultados gráficos de tales contrastes.</p>
<div id="fig-figTests" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figTests.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.8: Tests de diagnóstico sobre un ruido blanco simulado.</figcaption></figure>
</div>
<p>La primera fila se corresponde con la función de autocorrelación simple y parcial estimadas en las que cada coeficiente se puede comparar con su intervalo al <span class="math inline">\(95\%\)</span> de confianza para determinar si es o no significativo (valores que se salen de las bandas serán significativamente distintos de cero).</p>
<p>En la segunda fila aparecen tests de normalidad:</p>
<ul>
<li>A la izquierda se muestra un histograma junto con la función de densidad teórica de una distribución normal con la misma media y varianza que la muestra y una estimación no-paramétrica del histograma. La distribución será normal cuanto más se parezcan el histograma y su estimación no-paramétrica a la teórica.</li>
<li>A la derecha se muestra el <strong>gráfico Q-Q</strong> que compara los cuantiles de la muestra con los cuantiles de la distribución normal. En una muestra normal los cuantiles deben ser muy parecidos entre sí y los puntos deben ajustarse a la diagonal.</li>
</ul>
<p>En la tercera fila se muestran los tests <strong>CUSUM</strong> y <strong>CUSUMsq</strong> para contrastar que la emdia y varianza son constantes en el tiempo, respectivamente. Ambos tests se basan en estimaciones recursivas de la media y varianza de la muestra (estimaciones con número creciente de observaciones). El proceso será estacionario en media y varianza si los valores de los estadísticos (líneas continuas negras) se encuentran dentro de la bandas de confanza (discontinuas rojas).</p>
<p>Los contrastes gráficos se suelen complementar con otros formales:</p>
<ul>
<li>Es conveniente calcular los estadísticos básicos de posición, dispersión, asimetría y curtosis, que dan una idea sobre la distribución de la muestra.</li>
<li>Un test de media cero asumiendo que la muestra es independiente con varianza constante es muy sencillo de llevar a cabo.</li>
<li>Lo mismo sucede con un test de ratio de varianzas de dos segmentos de la muestra distantes entre sí para contrastar que la varianza es constante.</li>
<li>Existe gran variedad de contrastes de normalidad formales que se pueden utilizar, como el de Shapiro-Wilk.</li>
<li>El contraste de Ljung-Box de autocorrelación es también muy utilizado. Se basa en los cuadrados de las autocorrelaciones de retardos acumulados. La <a href="#tbl-tabLB">Tabla&nbsp;<span>2.1</span></a> muestra una salida que se utilizará en este libro para la serie de la <a href="#fig-figTests">Figura&nbsp;<span>2.8</span></a>. Las estimaciones de los coeficientes de autocorrelación simple y parcial aparecen bajo los nombres <em>SACF</em> y <em>SPACF</em> (‘s’ de <em>sample</em> o muestra). La significación individual de cada coeficiente se indica con puntos y signos positivos y negativos para los casos en que no son significativos o significativos por el lado positivo o negativo, respectivamente. El test Ljung-Box se encuentra en las columnas <em>LB</em> y <em>p.val</em> que proporcionan los valores del estadístico y el tamaño en términos de probabilidad de la región de no rechazo del test, de forma que si dicha probabilidad es superior al <span class="math inline">\(5\%\)</span> no se puede rechazar la hipótesis de no autocorrelación. Hay que tener en cuenta que este test contrasta la autocorrelaciones agregada hasta el retardo correspondiente. Por ejemplo, en la tabla aparece que para el retardo <span class="math inline">\(6\)</span> la probabilidad de no rechazo es del <span class="math inline">\(20\%\)</span> indicando que no existe autocorrelación <em>hasta</em> el retardo <span class="math inline">\(6\)</span>. Se puede comprobar que esa misma probabilidad cuando se añade un retardo es <span class="math inline">\(2,5\%\)</span> indicando que puede haber correlación hasta el retardo <span class="math inline">\(7\)</span>, sin embargo, en el correlograma de la <a href="#fig-figTests">Figura&nbsp;<span>2.8</span></a> se ve que esto se debe exclusivamente a un valor elevado de la autocorrelación de retardo <span class="math inline">\(7\)</span>.</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-tabLB" class="anchored">
<table class="table table-sm table-striped small">
<caption>Tabla&nbsp;2.1: Tests de autocorrelación.</caption>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">SACF</th>
<th style="text-align: right;">sa</th>
<th style="text-align: right;">LB</th>
<th style="text-align: right;">p.val</th>
<th style="text-align: right;">SPACF</th>
<th style="text-align: right;">sp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>1</strong></td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.829</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2</strong></td>
<td style="text-align: right;">-0.111</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">2.573</td>
<td style="text-align: right;">0.276</td>
<td style="text-align: right;">-0.112</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>3</strong></td>
<td style="text-align: right;">-0.059</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">3.276</td>
<td style="text-align: right;">0.351</td>
<td style="text-align: right;">-0.063</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>4</strong></td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">4.262</td>
<td style="text-align: right;">0.372</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5</strong></td>
<td style="text-align: right;">-0.141</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">8.371</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">-0.155</td>
<td style="text-align: right;">-</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>6</strong></td>
<td style="text-align: right;">-0.014</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">8.413</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">-0.009</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>7</strong></td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">+</td>
<td style="text-align: right;">16.030</td>
<td style="text-align: right;">0.025</td>
<td style="text-align: right;">0.173</td>
<td style="text-align: right;">+</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>8</strong></td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">16.921</td>
<td style="text-align: right;">0.031</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>9</strong></td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">17.222</td>
<td style="text-align: right;">0.045</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>10</strong></td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">.</td>
<td style="text-align: right;">18.182</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">Solución</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false">MATLAB/Octave</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Simula un ruido blanco normal de dimensión 300 con media 100 (<code>rnorm</code>), represéntala gráficamente y comprueba que la media es cien. Comprueba la autocorrelación. Realiza los tests de gaussianidad. Realiza los tests de heterocedasticidad. Realiza los tests CUSUM y CUSUMsq.</p>
<p>Simula un ruido blanco normal de dimensión 300 con media 100 y varianza 5 y estima todos los tests.</p>
<p>En todos los lenguajes puedes usar las funciones <code>gaussTest</code>, <code>varTest</code>, <code>cusum</code> y <code>tests</code>. Prueba además con <code>sumStats</code>, <code>ident</code> y/o <code>tsDisplay</code>. En <strong>MATLAB/Octave</strong> te puede ayudar <code>toolTEST</code>, <code>vident</code> y <code>sumstats</code>.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>La primera solución es la siguiente:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<pre><code>##                         Serie 1
## Data points:          300.00000
## Missing:                0.00000
## Minimum:               97.27983
## 1st quartile:          99.28604
## Mean:                 100.04715
## P(Mean = 0):            0.00000
## Median:               100.00691
## 3rd quartile:         100.77362
## Maximum:              102.88842
## Interquartile range:    1.48758
## Range:                  5.60859
## Satandard deviation:    1.06853
## Variance:               1.14176
## Skewness:               0.06186
## Kurtosis:              -0.40482</code></pre>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
<pre><code>##      SACF sa     LB p.val  SPACF sp
## 1  -0.024  .  0.173 0.677 -0.024  .
## 2   0.027  .  0.396 0.820  0.027  .
## 3  -0.056  .  1.342 0.719 -0.054  .
## 4  -0.033  .  1.669 0.796 -0.036  .
## 5  -0.069  .  3.151 0.677 -0.069  .
## 6   0.066  .  4.507 0.608  0.062  .
## 7  -0.093  .  7.193 0.409 -0.092  .
## 8  -0.019  .  7.310 0.504 -0.036  .
## 9   0.021  .  7.445 0.591  0.026  .
## 10 -0.034  .  7.803 0.648 -0.043  .
## 11 -0.052  .  8.644 0.655 -0.057  .
## 12 -0.009  .  8.669 0.731 -0.026  .
## 13 -0.004  .  8.674 0.797  0.003  .
## 14  0.104  . 12.071 0.601  0.095  .
## 15 -0.009  . 12.098 0.672 -0.026  .
## 16  0.069  . 13.597 0.629  0.066  .
## 17 -0.020  . 13.722 0.687 -0.006  .
## 18  0.003  . 13.725 0.747 -0.005  .
## 19 -0.024  . 13.904 0.789 -0.008  .
## 20  0.001  . 13.904 0.835 -0.011  .
## 21 -0.013  . 13.962 0.871  0.013  .
## 22 -0.053  . 14.869 0.868 -0.069  .
## 23 -0.141  - 21.402 0.557 -0.147  -
## 24 -0.045  . 22.058 0.576 -0.043  .
## 25  0.113  . 26.245 0.395  0.122  +
## 26 -0.050  . 27.074 0.405 -0.063  .
## 27  0.040  . 27.594 0.432  0.009  .
## 28  0.001  . 27.595 0.486 -0.004  .
## 29  0.037  . 28.055 0.515  0.048  .
## 30 -0.027  . 28.301 0.555 -0.056  .
## 31  0.043  . 28.920 0.573  0.009  .
## 32 -0.024  . 29.108 0.614  0.017  .
## 33 -0.064  . 30.502 0.592 -0.089  .
## 34  0.067  . 32.027 0.565  0.044  .
## 35  0.046  . 32.738 0.578  0.053  .
## 36 -0.044  . 33.391 0.593 -0.022  .
## 37 -0.002  . 33.392 0.639  0.012  .</code></pre>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-34-3.png" class="img-fluid" width="672"></p>
</div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  x
## W = 0.99469, p-value = 0.3861</code></pre>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-34-4.png" class="img-fluid" width="672"></p>
</div>
<pre><code>##  Portion_of_data F_statistic p.value
##          0.33333      1.2065   0.352</code></pre>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-34-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La segunda simulación es:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Summary statistics:
==================
                        Serie 1
Data points:          300.00000
Missing:                0.00000
Minimum:               93.91752
1st quartile:          98.40353
Mean:                 100.10543
P(Mean = 0):            0.00000
Median:               100.01546
3rd quartile:         101.72986
Maximum:              106.45870
Interquartile range:    3.32633
Range:                 12.54118
Satandard deviation:    2.38931
Variance:               5.70880
Skewness:               0.06186
Kurtosis:              -0.40482
Autocorrelation tests:
=====================
     SACF sa     LB p.val  SPACF sp
1  -0.024  .  0.173 0.677 -0.024  .
2   0.027  .  0.396 0.820  0.027  .
3  -0.056  .  1.342 0.719 -0.054  .
4  -0.033  .  1.669 0.796 -0.036  .
5  -0.069  .  3.151 0.677 -0.069  .
6   0.066  .  4.507 0.608  0.062  .
7  -0.093  .  7.193 0.409 -0.092  .
8  -0.019  .  7.310 0.504 -0.036  .
9   0.021  .  7.445 0.591  0.026  .
10 -0.034  .  7.803 0.648 -0.043  .
11 -0.052  .  8.644 0.655 -0.057  .
12 -0.009  .  8.669 0.731 -0.026  .
13 -0.004  .  8.674 0.797  0.003  .
14  0.104  . 12.071 0.601  0.095  .
15 -0.009  . 12.098 0.672 -0.026  .
16  0.069  . 13.597 0.629  0.066  .
17 -0.020  . 13.722 0.687 -0.006  .
18  0.003  . 13.725 0.747 -0.005  .
19 -0.024  . 13.904 0.789 -0.008  .
20  0.001  . 13.904 0.835 -0.011  .
21 -0.013  . 13.962 0.871  0.013  .
22 -0.053  . 14.869 0.868 -0.069  .
23 -0.141  - 21.402 0.557 -0.147  -
24 -0.045  . 22.058 0.576 -0.043  .
25  0.113  . 26.245 0.395  0.122  +
Gaussianity tests:
=================

    Shapiro-Wilk normality test

data:  x
W = 0.99469, p-value = 0.3861

Ratio of variance tests:
=======================
 Portion_of_data F_statistic p.value
         0.33333      1.2065   0.352</code></pre>
</div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cargando librerías</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">UComp</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Simulando números aleatorios</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span></span>
<span><span class="co"># Gráfico</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ts.html">as.ts</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Estadísticos</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/sumStats.html">sumStats</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co"># Identificación</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/ident.html">ident</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/tsDisplay.html">tsDisplay</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co"># Tests de gaussianidad</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/gaussTest.html">gaussTest</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co"># Tests de heterocedasticidad</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/varTest.html">varTest</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co"># Tests CUSUM</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/cusum.html">cusum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="co"># Segunda simulación</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/tests.html">tests</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> UComp <span class="im">import</span> <span class="op">*</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulando números aleatorios</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.normal(<span class="dv">100</span>, <span class="dv">1</span>, <span class="dv">300</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.plot(y)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Estadísticos</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>sumStats(y)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Identificación</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>ident(y)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>tsDisplay(y)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests de gaussianidad</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>gaussTest(y)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests de heterocedasticidad</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>varTest(y)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Tests CUSUM</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>cusum(y)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Segunda simulación</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.normal(<span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">300</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>tests(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<p>En MATLAB se recomienda usar la función <code>toolTEST</code>en el que se pueden ver todos los tests y muchos más, en realidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>clear <span class="bu">all</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Simulando números aleatorios</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> randn(<span class="dv">300</span>, <span class="dv">1</span>) <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Tests</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>toolTEST(y)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Segunda simulación</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> rnorm(<span class="dv">300</span>) <span class="op">*</span> sqrt(<span class="dv">5</span>) <span class="op">+</span> <span class="dv">100</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>toolTEST(y)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="métodos-y-modelos-de-predicción" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="métodos-y-modelos-de-predicción">
<span class="header-section-number">2.5</span> Métodos y modelos de predicción</h2>
<p>Cuando se analizan datos cuantitativos (también cualitativos, pero nos centraremos en los cuantitativos) lo usual es utilizar <strong>métodos de predicción</strong> o <strong>modelos estadísticos</strong>. Los métodos son reglas heurísticas de predicción, basándonos en propiedades de las series a analizar y el sentido común. Los modelos estadísticos, por el contrario, son formulaciones matemáticas del problema en las que existe (necesariamente para que sea estadístico) algún componente aleatorio.</p>
<p>Algunos métodos sencillos de predicción puntuales pueden ser los siguientes:</p>
<ul>
<li>
<strong>Media</strong>: la predicción será sencillamente la media de la serie. Es evidente que esta predicción será prudente cuando se observe un nivel medio constante en la serie temporal, pero en general será poco recomendable.</li>
<li>
<strong><em>Naive</em></strong> o <strong>ingenuo</strong>: consiste en predecir el futuro utilizando la última observación y prolongándola hacia adelante.</li>
<li>
<strong><em>Naive</em></strong> <strong>con estacionalidad</strong>: en aquellas series que tienen estacionalidad consistiría en proyectar hacia el futuro el último año completo observado.</li>
<li>
<strong>Media anual</strong> (media del último año): predice el futuro con la media del último año.</li>
</ul>
<p>La <a href="#fig-fig13">Figura&nbsp;<span>2.9</span></a> ilustra la predicción de estos métodos en una serie real. Es evidente que la media predice muy por debajo de lo que pueden ser las observaciones futuras reales. Lo mismo sucede con el <em>naive</em>. El método con estacionalidad parece mucho más apropiado, aunque, dada la inercia ascendente de la serie, con toda seguridad predice por debajo de los valores reales.</p>
<div id="fig-fig13" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="fig13.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.9: Ejemplos de predicción con métodos sencillos.</figcaption></figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Estos métodos son tan sencillos de aplicar que cualquier método o modelo más sofisticado debería ser capaz de mejorar sus predicciones por un amplio margen. Es una buena práctica utilizar estos modelos como opciones mínimas con qué comparar cualquier otro.</p>
</div>
</div>
<p>Aunque no todos los métodos de predicción que se puedan pensar son formalizables como modelos estadísticos, muchos, como los expuestos más arriba, sí se corresponden con modelos estadísticos que le dan un soporte más riguroso. La ventaja de utilizar modelos es que se puede comprobar empíricamente si una serie se corresponde con un modelo utilizado, y por tanto, si la predicción es óptima. Si el modelo al que corresponde el método utilizado no es adecuado, las predicciones podrán ser mejoradas cuando se utilice otro método/modelo alternativo. A continuación se citan dos ejemplos, que se completarán en el ejercicio propuesto al final del capítulo.</p>
<ol type="1">
<li>El método de la <strong>media</strong> será correcto cuando la serie temporal es ruido blanco más una constante, que será la media y habrá que estimar en cada caso:
<ul>
<li>Formulación: <span class="math inline">\(y_t=c+a_t\)</span>.</li>
<li>Estimación: el único parámetro a estimar sería la media (<span class="math inline">\(c\)</span>), cuya estimación óptima es la media de la serie, es decir, <span class="math inline">\(\hat{c}=1/n\sum_{t=1}^n{y_t}\)</span>.</li>
<li>Diagnóstico: la serie <span class="math inline">\(\hat{a}_t=y_t-\hat{c}\)</span> debe ser ruido blanco con media cero y varianza constante.</li>
<li>Predicción: la predicción óptima es la media estimada, <span class="math inline">\(\hat{y}_{T+l|T}=\hat{c}\)</span>.</li>
</ul>
</li>
<li>El método de predicción <strong>naive</strong> se corresponde con un paseo aleatorio:
<ul>
<li>Formulación: <span class="math inline">\(y_t=y_{t-1}+a_t\)</span>.</li>
<li>Estimación: no hay ningún parámetro que estimar.</li>
<li>Diagnóstico: si se estima la diferencia de la serie tenemos <span class="math inline">\(\hat{a}_t=y_t-y_{t-1}\)</span>, que es ruido blanco. Es decir, la forma de comprobar que una serie sigue un paseo aleatorio es examinando que la primera diferencia es ruido blanco con media cero y varianza constante.</li>
<li>Predicción: última observación disponible <span class="math inline">\(\hat{y}_{T+l|T}=y_T\)</span>.</li>
</ul>
</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Resuelve</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">Solución</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">Python</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">MATLAB/Octave</a></li>
</ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<p>Escribe una función con las siguientes características:</p>
<ul>
<li>Nombre: <code>simpleMethods</code>.</li>
<li>Entradas: una serie temporal y el horizonte de predicción.</li>
<li>Salidas: <code>predicciones</code> y <code>residuos</code>, que pueden ser salidas individuales o en una lista, dependiendo del lenguaje que uses. En <code>predicciones</code> se devuelven las predicciones del método de la media (ruido blanco) y naive (paseo aleatorio). En <code>residuos</code> se devuelven los residuos de cada modelo, respectivamente. Para que sea más estético puedes poner nombres a las columnas que ayuden a identificar los modelos.</li>
</ul>
<p>Simula un paseo aleatorio con una condición inicial de 100 y representa gráficamente la serie con las predicciones de los dos métodos, y en otro gráfico los residuos de los dos métodos. ¿Son adecuados los modelos?</p>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>Una vez construida la función (ver las pestañas de cada lenguaje), la solución es</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La adecuación de los modelos se puede ver con la función <code>tests</code>. Los primeros residuos indican que el primer modelo no es correcto y el segundo sí.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Summary statistics:
==================
                        Serie 1
Data points:          150.00000
Missing:                0.00000
Minimum:              -19.60714
1st quartile:          -7.75692
Mean:                   0.00000
P(Mean = 0):            1.00000
Median:                 4.46768
3rd quartile:           7.44709
Maximum:               13.43764
Interquartile range:   15.20401
Range:                 33.04478
Satandard deviation:    9.97561
Variance:              99.51273
Skewness:              -0.74110
Kurtosis:              -0.90106
Autocorrelation tests:
=====================
    SACF sa       LB p.val  SPACF sp
1  0.983  +  147.988     0  0.983  +
2  0.966  +  291.729     0 -0.036  .
3  0.947  +  430.847     0 -0.051  .
4  0.927  +  564.999     0 -0.049  .
5  0.906  +  694.006     0 -0.032  .
6  0.886  +  818.292     0  0.032  .
7  0.864  +  937.313     0 -0.076  .
8  0.843  + 1051.505     0  0.030  .
9  0.824  + 1161.254     0  0.026  .
10 0.804  + 1266.589     0 -0.016  .
11 0.784  + 1367.326     0 -0.041  .
12 0.761  + 1463.106     0 -0.073  .
13 0.739  + 1554.033     0  0.000  .
14 0.715  + 1639.662     0 -0.078  .
15 0.690  + 1720.003     0 -0.025  .
16 0.666  + 1795.502     0  0.037  .
17 0.644  + 1866.499     0  0.021  .
18 0.621  + 1933.010     0 -0.023  .
19 0.598  + 1995.191     0 -0.027  .
20 0.574  + 2053.031     0 -0.033  .
21 0.549  + 2106.243     0 -0.081  .
22 0.524  + 2155.094     0 -0.001  .
23 0.499  + 2199.863     0  0.012  .
24 0.475  + 2240.713     0  0.001  .
25 0.452  + 2277.982     0  0.028  .
Gaussianity tests:
=================

    Shapiro-Wilk normality test

data:  x
W = 0.85966, p-value = 1.212e-10

Ratio of variance tests:
=======================
 Portion_of_data F_statistic p.value
         0.33333      4.9442       0</code></pre>
</div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary statistics:
==================
                        Serie 1
Data points:          150.00000
Missing:                1.00000
Minimum:               -2.72182
1st quartile:          -0.44052
Mean:                   0.14530
P(Mean = 0):            0.07289
Median:                 0.17498
3rd quartile:           0.87184
Maximum:                2.53311
Interquartile range:    1.31236
Range:                  5.25493
Satandard deviation:    0.98189
Variance:               0.96410
Skewness:              -0.33320
Kurtosis:               0.05596
Autocorrelation tests:
=====================
     SACF sa     LB p.val  SPACF sp
1   0.042  .  0.272 0.602  0.042  .
2   0.188  +  5.696 0.058  0.187  +
3  -0.101  .  7.253 0.064 -0.119  .
4   0.140  . 10.277 0.036  0.120  .
5  -0.057  . 10.784 0.056 -0.033  .
6   0.234  + 19.383 0.004  0.194  +
7  -0.033  . 19.557 0.007 -0.023  .
8  -0.025  . 19.656 0.012 -0.125  .
9  -0.105  . 21.438 0.011 -0.036  .
10  0.090  . 22.755 0.012  0.077  .
11  0.081  . 23.813 0.014  0.120  .
12 -0.097  . 25.357 0.013 -0.211  -
13 -0.044  . 25.678 0.019 -0.030  .
14 -0.063  . 26.342 0.023  0.026  .
15 -0.115  . 28.563 0.018 -0.117  .
16  0.023  . 28.649 0.026  0.047  .
17  0.063  . 29.322 0.032  0.026  .
18 -0.062  . 29.981 0.038 -0.025  .
19  0.002  . 29.982 0.052  0.062  .
20  0.099  . 31.695 0.047  0.122  .
21  0.058  . 32.280 0.055  0.023  .
22 -0.012  . 32.304 0.072 -0.073  .
23  0.026  . 32.426 0.092  0.036  .
24 -0.096  . 34.079 0.083 -0.121  .
25 -0.013  . 34.109 0.106  0.013  .
Gaussianity tests:
=================

    Shapiro-Wilk normality test

data:  x
W = 0.98775, p-value = 0.2149

Ratio of variance tests:
=======================
 Portion_of_data F_statistic p.value
         0.33333        0.59  0.0706</code></pre>
</div>
<div class="cell-output-display">
<p><img src="07-basicsts_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Función</span></span>
<span><span class="va">simpleMethods</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">h</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html">frequency</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  <span class="co"># Inicializando salidas</span></span>
<span>  <span class="va">predicciones</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">h</span>, <span class="fl">2</span><span class="op">)</span>, frequency<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html">frequency</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/plus_one.html">plus_one</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">residuos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">n</span>, <span class="fl">2</span><span class="op">)</span>, frequency<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/time.html">frequency</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html">start</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">predicciones</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"media"</span>, <span class="st">"naive"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">residuos</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"media"</span>, <span class="st">"naive"</span><span class="op">)</span></span>
<span>  <span class="co"># Estimando predicciones</span></span>
<span>  <span class="va">predicciones</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">predicciones</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co"># Estimando residuos</span></span>
<span>  <span class="va">residuos</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">predicciones</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">residuos</span><span class="op">[</span><span class="fl">2</span> <span class="op">:</span> <span class="va">n</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="fl">2</span> <span class="op">:</span> <span class="va">n</span><span class="op">]</span> <span class="op">-</span> <span class="va">y</span><span class="op">[</span><span class="fl">1</span> <span class="op">:</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>predicciones<span class="op">=</span><span class="va">predicciones</span>, residuos<span class="op">=</span><span class="va">residuos</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Simulación de paseo aleatorio</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">150</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">n</span><span class="op">)</span>, frequency <span class="op">=</span> <span class="fl">12</span>, start<span class="op">=</span><span class="fl">2000</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span> <span class="op">:</span> <span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">t</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">a</span><span class="op">[</span><span class="va">t</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Llamada a la función simpleMethods</span></span>
<span><span class="va">salida</span> <span class="op">=</span> <span class="fu">simpleMethods</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co"># Representando predicciones</span></span>
<span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autolayer.html">autolayer</a></span><span class="op">(</span><span class="va">salida</span><span class="op">$</span><span class="va">predicciones</span><span class="op">)</span></span>
<span><span class="co"># Representando residuos</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">salida</span><span class="op">$</span><span class="va">residuos</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span>,</span>
<span>            layout_matrix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Comprobando si los modelos son adecuados</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/tests.html">tests</a></span><span class="op">(</span><span class="va">salida</span><span class="op">$</span><span class="va">residuos</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/UComp/man/tests.html">tests</a></span><span class="op">(</span><span class="va">salida</span><span class="op">$</span><span class="va">residuos</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Función</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simpleMethods(y, h<span class="op">=</span><span class="dv">4</span>):</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(y)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Inicializando salidas</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    predicciones <span class="op">=</span> pd.DataFrame(np.full((h, <span class="dv">2</span>), np.nan))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    predicciones.index <span class="op">=</span> <span class="bu">range</span>(<span class="bu">len</span>(y), <span class="bu">len</span>(y) <span class="op">+</span> h)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    residuos <span class="op">=</span> pd.DataFrame(np.full((n, <span class="dv">2</span>), np.nan))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    predicciones.columns <span class="op">=</span> [<span class="st">"media"</span>, <span class="st">"naive"</span>]</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    residuos.columns <span class="op">=</span> [<span class="st">"media"</span>, <span class="st">"naive"</span>]</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Estimando predicciones</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    predicciones.iloc[:, <span class="dv">0</span>] <span class="op">=</span> np.mean(y)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    predicciones.iloc[:, <span class="dv">1</span>] <span class="op">=</span> y[<span class="op">~</span>np.isnan(y)].values[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Estimando residuos</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    residuos.iloc[:, <span class="dv">0</span>] <span class="op">=</span> y <span class="op">-</span> predicciones.iloc[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    residuos.iloc[<span class="dv">1</span> : n, <span class="dv">1</span>] <span class="op">=</span> y[<span class="dv">1</span> : n].values <span class="op">-</span> y[<span class="dv">0</span> : (n <span class="op">-</span> <span class="dv">1</span>)].values</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"predicciones"</span>: predicciones, <span class="st">"residuos"</span>: residuos}</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de paseo aleatorio</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(<span class="dv">0</span>, <span class="dv">1</span>, n)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> pd.Series(np.full(n, <span class="fl">0.0</span>))</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n):</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  x[t] <span class="op">=</span> x[t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> a[t]</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Llamada a la función simpleMethods</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>salida <span class="op">=</span> simpleMethods(x)</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Representando predicciones</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>plt.plot(x[<span class="op">-</span><span class="dv">30</span>:])</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>plt.plot(salida[<span class="st">"predicciones"</span>])</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Representando residuos</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>plt.plot(salida[<span class="st">"residuos"</span>])</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprobando si los modelos son adecuados</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>tests(np.array(salida[<span class="st">"residuos"</span>][<span class="st">"media"</span>]))</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>tests(np.array(salida[<span class="st">"residuos"</span>][<span class="st">"naive"</span>]))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Función</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>function salida <span class="op">=</span> simpleMethods(y, h)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> nargin <span class="op">&lt;</span> <span class="dv">2</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        h <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    end</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> length(y)<span class="op">;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> Inicializando salidas</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    predicciones <span class="op">=</span> nan(h, <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    residuos <span class="op">=</span> nan(n, <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> Estimando predicciones</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    predicciones(:, <span class="dv">1</span>) <span class="op">=</span> mean(y)<span class="op">;</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    predicciones(:, <span class="dv">2</span>) <span class="op">=</span> y(<span class="op">~</span>isnan(y))(end)<span class="op">;</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">%</span> Estimando residuos</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    residuos(:, <span class="dv">1</span>) <span class="op">=</span> y <span class="op">-</span> predicciones(end, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    residuos(<span class="dv">2</span> : n, <span class="dv">2</span>) <span class="op">=</span> y(<span class="dv">2</span> : n) <span class="op">-</span> y(<span class="dv">1</span> : (n <span class="op">-</span> <span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    salida <span class="op">=</span> struct(<span class="st">'predicciones'</span>, predicciones, <span class="st">'residuos'</span>, residuos)<span class="op">;</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Simulación de paseo aleatorio</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">150</span><span class="op">;</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> randn(n, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> zeros(n, <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="op">=</span> <span class="dv">2</span> : n</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    x(t) <span class="op">=</span> x(t <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> a(t)<span class="op">;</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>end</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Llamada a la función simpleMethods</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>salida <span class="op">=</span> simpleMethods(x)<span class="op">;</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Representando predicciones</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> (n <span class="op">-</span> <span class="dv">50</span> : n)<span class="st">';</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="er">plot</span>(t, x(t), (n <span class="op">+</span> <span class="dv">1</span> : n <span class="op">+</span> <span class="dv">4</span>), salida.predicciones)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="op">%</span> Representando residuos y comprobando adecuación de modelos</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>toolTEST(salida.residuos)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="esquema-general-de-análisis-de-series-temporales" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="esquema-general-de-análisis-de-series-temporales">
<span class="header-section-number">2.6</span> Esquema general de análisis de series temporales</h2>
<p>Con todo lo visto hasta el momento, lo único que resta es plantear el esquema general de análisis de series temporales, que se muestra en la <a href="#fig-figPred">Figura&nbsp;<span>2.10</span></a>. Lo primero es que hay que tener claro el problema que se quiere resolver y disponer de datos cuantitativos.</p>
<div id="fig-figPred" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="figPred.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figura&nbsp;2.10: Esquema general de análisis de series temporales.</figcaption></figure>
</div>
<p>Es conveniente siempre realizar un análisis exploratorio de los datos para tener una evidencia inicial sobre la calidad y la escala de los mismos, periodo de muestreo, la longitud en el tiempo, anomalías que se pueden detectar a simple vista, estacionariedad en media y varianza, tendencias, estacionalidades, nivel de ruido, etc. Es una fase de la que ya se puede tener una buena intuición de los resultados que se pueden esperar y los problemas con que el analizador se va a encontrar. Dentro de esta fase también se suele dividir la muestra en un <strong><em>training set</em></strong> y un <strong><em>test set</em></strong>. El <em>training set</em> es la parte de la muestra inicial con la que se realiza todo el análisis. El <em>test set</em> son los datos que se apartan de la muestra y sirven de evaluación final de nuestros modelos. Estos últimos no se utilizan en el proceso de modelización, sino solo para evaluación. Aunque se suele recomendar reservar un <span class="math inline">\(25\%\)</span> de la muestra como test set, la proporción puede variar en función de muchas circunstancias. Lo normal es que las predicciones en tiempo real se lleven a cabo con el mejor modelo re-estimado para toda la muestra.</p>
<p>El siguiente paso será explorar si son necesarias transformaciones que hagan los datos más conformables con los métodos estadísticos que se utilizarán más tarde. Como ya hemos visto, una de las cuestiones a comprobar es la estacionariedad en varianza mediante la transformación Box-Cox, que nunca está de más explorar. Dependiendo de los modelos que se vayan a utilizar, la estacionariedad en media mediante diferencias también será un tema a tratar. Los métodos que se utilizarán en este libro, sin embargo, no necesitan diferenciación.</p>
<p>La fase de identificación consiste en buscar el modelo concreto apropiado a cada serie temporal dentro de una familia que se quiere investigar. Por ejemplo, más tarde se introducirán los modelos de suavizado exponencial, pero hay muchos tipos dentro de esta familia, dependiendo de la versión concreta de tendencia y estacionalidad que se elijan. La identificación consiste en elegir una versión concreta de todos esos componentes que sea adecuada para la serie a tratar.</p>
<p>La estimación consiste en buscar los parámetros óptimos de los que depende el modelo identificado en la fase anterior por algún método estadístico, habitualmente <strong>Máxima Verosimilitud</strong>. Es importante escalar los datos para evitar magnitudes muy grandes o muy pequeñas que pueden llevar a errores numéricos en el proceso de optimización. El mismo modelo identificado puede generar comportamientos dinámicos muy diferentes en función de los valores de los parámetros que se asignen.</p>
<p>La fase de diagnóstico consiste en analizar si el modelo estimado es coherente con los datos que se están analizando. En particular, interesará ver que los parámetros estimados son significativos, que no se ha producido ninguna anomalía en la estimación como errores numéricos, etc. Si el modelo conlleva estimación de componentes también conviene asegurarse de que dichos componentes son lo que se espera de ellos. Finalmente, habrá que comprobar que los residuos son ruido blanco con la batería de contrastes propuestos en la sección anterior.</p>
<p>Cuando algún modelo pasa los tests de diagnóstico se pasa a utilizar el o los modelos en predicción y compararlos entre sí o con algún estándar establecido. Dependiendo del contexto, esta fase se complementa con la ayuda de expertos (<em>judgemental forecasting</em>) que corrigen las predicciones producidas por los modelos estadísticos basándose en su experiencia personal en el sector.</p>
<p>La prueba definitiva es probar los modelos en el <em>test set</em> o <strong>fuera de la muestra</strong>. Si los errores de predicción son aceptables se pasará a usar el modelo en modo producción. Pero si hay alguna deficiencia habrá que volver a alguna de las fases anteriores. Hay que tener en cuenta que los tipos de errores, así como el resultado de los tests de diagnóstico, nos pueden dar indicaciones de si tenemos que volver al principio del análisis o basta con hacer una identificación más fina o utilizar otro método de estimación.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Todo este proceso se puede realizar manualmente, aunque algunas fases se pueden automatizar. De hecho hay un interés creciente en la automatización como consecuencia de las ingentes cantidades de información que hoy día se quiere procesar en tiempo récord. Las fases automatizables hasta el momento son las de la transformación, identificación y estimación. Hay que avisar que con excesiva frecuencia se tratan los datos de modo completamente automático, sin ni siquiera realizar un mínimo de análisis exploratorio. El riesgo de obtener resultados absurdos o mediocres es muy alto en esos casos.</p>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./01-intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-etsSSOE.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Suavizado Exponencial</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>